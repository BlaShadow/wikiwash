.wrapper
  include ./header

  .content-wrapper
    .content-left(ng-class="{active: tab=='history'}")
      .export-history
        span(ng-i18next='phrase.revs-realtime-edits')
        a(href="", ng-csv="sessionCsv()", filename="{{csv_filename}}" ng-i18next='phrase.revs-download-csv')

      .collection(fixed-height offset="150")
        .revisions(ng-repeat='revision in revisions track by $index'
          ng-class="{ 'active-revision': currentRevId == revision.revid }"
          class="{{$index == 0 ? 'wow fadeInDown' : ''}}")
          a.revision-link(
            ng-click="showRevision({ page: pageName, revId: revision.revid + '-' + revision.parentid })"
            title="{{'phrase.revs.view'|i18next}}"
          )
          .timestamp
            p {{revision.timestamp | date:'shortTime'}}
            p.date {{revision.timestamp | date:'mediumDate'}}
          .user_comment
            a(
              href="https://en.wikipedia.org/wiki/Special:Contributions/{{revision.user}}"
              target="_blank"
              title="{{'phrase.revs-viewprevious'|i18next}}"
            )
              p.username {{revision.user}}
            span(ng-if="revision.geo")
              a.geo(
                target="_blank"
                href="https://www.google.com/maps/search/{{revision.geo}}/"
                title="{{'phrase.revs-view-googlemaps'||i18next}}"
              ) {{revision.geo}}
            a(
              href="{{ 'p.revision' | routeSegmentUrl: { page: pageName, revId: revision.revid + '-' + revision.parentid } }}"
              title="{{'phrase.revs.view'|i18next}}"
            )
              p.comment(ng-if="revision.comment.length > 0", ng-click="showRevision({ page: pageName, revId: revision.revid + '-' + revision.parentid })") {{revision.comment}}
              p.comment(ng-if="revision.comment.length <= 0", ng-click="showRevision({ page: pageName, revId: revision.revid + '-' + revision.parentid })" ng-i18next='phrase.revs-nocomment')
          .data
            p.added {{revision.added ? "+" + revision.added : ''}}
            p.removed {{revision.removed ? "-" + revision.removed : ''}}
      .footer
        .top-stats
          p
            span(ng-i18next='[i18next]({edits:revisions.length,people:totalUsers})phrase.revs-edits-by-people')
            | 
            {{firstEditDate | date: 'mediumDate'}}
        .bottom-stats
          .edits-per-user
            p(ng-i18next='phrase.revs-avg-edits-user')
            p.number {{editsPerUser}}
          .time-between-edits
            p(ng-i18next='phrase.revs-avg-time-between')
            p.number(ng-i18next='[i18next]({count:timeBetweenEdits})noun.revs-hours')

    .content-right(ng-show="noResults", ng-class="{active: tab=='article'}")
      .wikidiff.mw-headline(ng-i18next='phrase.revs-notfound')

    .content-right(app-view-segment="1", ww-scroll, fixed-height, offset="75", ng-class="{active: tab=='article'}")
      .ww-loading(ng-show="loading")
        img.animated-infinite.zoomOutRight(src="/img/WIKIWASH-W1-Loading.png")
        img.animated-infinite.zoomOutLeft(src="/img/WIKIWASH-W2-Loading%402x.png")

.overlay(ng-show="$root.showModal" ng-click="$root.showModal = !$root.showModal")

include ./about-modal
