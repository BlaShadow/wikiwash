.wrapper
  .header
    .logo
      a(href="/")
        img(src="/img/WIKIWASH-Logo-Header%402x.png")
    .search
      form(ng-submit="getNewPage()")
        input.bar(type="text" ng-model="pageName")
    .navigation
      p Show:
      .removed
        input(type="checkbox" name="removed" id="removed" ng-model="showRemoved")
        label(for="removed") Removed
      .added
        input(type="checkbox" name="added" id="added" ng-model="showAdded")
        label(for="added") Added

    a.export-session(
      href=""
      ng-csv="sessionCsv()"
      filename="wikiwash-session.csv") Export Session

    a.export-session.about-button(
      href=""
      ng-click="showModal = !showModal"
      ng-class="{active: showModal}") About

      


  .content-wrapper
    .content-left
      .collection(fixed-height offset="150")
        .revisions(ng-repeat='revision in revisions track by $index'
          ng-class="{ 'active-revision': currentRevId == revision.revid }"
          class="{{$index == 0 ? 'wow fadeInDown' : ''}}")

          .timestamp
            p {{revision.timestamp | date:'shortTime'}}
            p.date {{revision.timestamp | date:'mediumDate'}}
          .user_comment
            a(
              href="https://en.wikipedia.org/wiki/Special:Contributions/{{revision.user}}"
              target="_blank")
              p.username {{revision.user}}
            a(href="{{ 'p.revision' | routeSegmentUrl: {page: pageName, revId: revision.revid + '-' + revision.parentid} }}")
              p.comment(ng-if="revision.comment.length > 0") {{revision.comment}}
              p.comment(ng-if="revision.comment.length <= 0") Comment was not entered.
          .data
            p.added {{revision.added ? "+" + revision.added : ''}}
            p.removed {{revision.removed ? "-" + revision.removed : ''}}
      .footer
        .top-stats
          p {{revisions.length}} edits by {{totalUsers}} people since {{ firstEditDate | date: 'mediumDate'}}
        .bottom-stats
          .edits-per-user
            p Avg edits/user
            p.number {{editsPerUser}}
          .time-between-edits
            p Avg time between edits
            p.number {{timeBetweenEdits}} Hours

    .ww-loading(ng-show="loading")
      img.animated-infinite.zoomOutRight(src="/img/WIKIWASH-W1-Loading.png")
      img.animated-infinite.zoomOutLeft(src="/img/WIKIWASH-W2-Loading%402x.png")

    .content-right(app-view-segment="1" ww-scroll)

.about-popup#light(ng-show="showModal")
  .scroll-container
    .popup-header
      .title
        p Why Wikiwash?
      .close
        a(href="" ng-click="showModal = !showModal") X
    .content
      p <strong>WikiWash (Beta)</strong> is a free public tool that allows journalists, citizens and activists to uncover spin and bias on Wikipedia by tracking page edits in real time. The platform aims to make political and corporate spin on Wikipedia more visible and discoverable and promote accountability and transparency through crowdsourcing.
      p Pick a Wikipedia article to explore, and use WikiWash to:
      ul
        li Track edits and see what’s being removed and added in real time
        li Follow breaking stories through the lens of their Wikipedia edits
        li Download the data so you can dive deeper
      p WikiWash was created by a team of journalists from Metro News Canada in partnership with The Working Group. The idea was born at TechRaking Toronto, the conference for data in the newsroom hosted by the Centre for Investigative Reporting and Google Canada.
      p The Beta version of WikiWash is a proof-of-concept prototype that explores how a tool like this might be used to uncover stories in Wikipedia. We’re excited to put it in your hands to see what emerges and where we might be able to take it next. Feel free to <a href="mailto:wikiwash@twg.ca">get in touch</a> and share your stories and ideas.
      .images
        a(href="http://metronews.ca/" target="_blank")
          img.metro-logo(src="/img/metro-white.png")
        a(href="http://twg.ca/" target="_blank")
          img.metro-logo(src="/img/twg-white.png")
        a(href="http://www.centerforinvestigativereporting.org/" target="_blank")
          img.metro-logo(src="/img/cir-white.png")
    .trdmrk
      p © Wikiwash 2014
